services:
  # Next.js Frontend (Alternative to Vercel)
  - type: web
    name: sarkari-result-hub-web
    env: node
    buildCommand: npm install && npm run build
    startCommand: npm start
    envVars:
      - key: DATABASE_URL
        sync: false
      - key: NEXTAUTH_SECRET
        sync: false
      - key: NEXT_PUBLIC_SENTRY_DSN
        sync: false
    autoDeploy: true
    plan: starter

  # Background Worker (for Notifications/Cron jobs)
  - type: worker
    name: sarkari-result-hub-worker
    env: node
    buildCommand: npm install
    startCommand: npm run worker
    envVars:
      - key: DATABASE_URL
        sync: false
    autoDeploy: true
    plan: starter

databases:
  - name: sarkari-db
    plan: starter
    databaseName: sarkari_result_hub
    user: admin

  - name: sarkari-redis
    plan: starter
    ipAllowList: [] # Allow all internal connections
